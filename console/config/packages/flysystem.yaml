services:
    s3_client:
        class: 'AsyncAws\S3\S3Client'
        arguments:
            -
                endpoint: '%env(resolve:APP_CDN_S3_ENDPOINT)%'
                accessKeyId: '%env(resolve:APP_CDN_S3_ACCESS_KEY_ID)%'
                accessKeySecret: '%env(resolve:APP_CDN_S3_ACCESS_KEY_SECRET)%'

flysystem:
    storages:
        #
        # CDN
        #
        cdn.storage.memory:
            adapter: 'memory'

        cdn.storage.s3:
            adapter: 'asyncaws'
            options:
                client: 's3_client'
                bucket: '%env(resolve:APP_CDN_S3_BUCKET)%'

        cdn.storage.local:
            adapter: 'local'
            options:
                directory: '%kernel.project_dir%/var/storage/cdn'

        cdn.storage:
            adapter: 'lazy'
            options:
                source: '%env(resolve:APP_CDN_STORAGE)%'

        #
        # Screenshots
        #
        tools.screenshots.storage:
            adapter: 'local'
            options:
                directory: '%kernel.project_dir%/var/storage/screenshots'
